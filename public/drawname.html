<!Doctype html>
<html>
	<head>
	<title>数字化名字</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<style>
	.btn
	{
		margin-left:10px;
		margin-top:10px;
		border-color: grey;
		border-radius: 3px;
		background-color:white;
		width: 60px;
		height: 30px;
		font-size: 15px;
	}
	</style>
	</head>
<body onload="DrawDesk()">
<a style="font-size:16px;">文件路径 >>> </a>
<input type="file" id="file" multiple="mutifile" style="width:160px;height:25px;"/>
<a style="font-size:13px;color:grey"><输入gen格式的txt数据，并且按照字顺序命名文件，不得超过3个文件></a>
<br/>
<a style="font-size:16px;margin-top:8px;">画笔设置 >>> </a>
<a style="font-size:16px;margin-top:8px;">颜色：</a>
<select id="color" style = "width:70px;">
	<option value ="red">Red</option>
	<option value ="blue">Blue</option>
	<option value="green">Green</option>
	<option value="black">Black</option>
	<option value="yellow">Yellow</option>
</select>
<a style="margin-left:10px;margin-top:8px;">宽度：</a>
<input id = "wid" style="width:30px;margin-top:8px;"/>
<br />
<button class="btn" onclick="GetName()">显示</button>
<button class="btn"s onclick="clearCanvas();DrawDesk()">清空</button>
<br/>
<canvas id="canvas" style="border:1px solid #000;margin-top:20px;"></canvas>
<script language="javascript">
	var canvas = document.getElementById('canvas');
	var ctx=canvas.getContext('2d');
	canvas.width = 1200;
    canvas.height = 400;
	var startX = 50;  //起始位置X
	var startY = 50; //起始位置Y
	var number = 3;   //字数目
	var a = 20;       //方格边长
	var dis = 400;    //方格间隔


	//清空画布
	function clearCanvas()
	{
		ctx.clearRect(0,0,canvas.width,canvas.height);  
	}

	function DrawDesk()
	{
		//棋盘的第一个字起始点为(40,70)，第二个为(40+400,70),依次类推
		for(var k=0;k<number;k++)
		{	
			//画纵线
			for(var i=0;i<16;i++)
			{
				ctx.strokeStyle = "grey";
				ctx.lineWidth = parseInt(1);
				ctx.beginPath();
				ctx.moveTo(startX+a*i+k*dis, startY);
				ctx.lineTo(startX+a*i+k*dis, a*15 + startY);
				ctx.stroke();
			}

			//画横线
			for(var i=0;i<16;i++)
			{
				ctx.strokeStyle = "grey";
				ctx.lineWidth = parseInt(1);
				ctx.beginPath();
				ctx.moveTo(startX+k*dis,startY+a*i);
				ctx.lineTo(startX+ a*15 +k*dis,startY+a*i);
				ctx.stroke();
			}
		}

	}

    function GetName()
    {
		var files = document.getElementById('file').files;
		for(var i=0;i<files.length;i++)
		{
			var file = files[i];
			var reader = new FileReader();
			var content = null;
			reader.readAsText(file);
			var n = 0;
			reader.onload = function(e)
			{
				content = this.result;
				DrawName(content,n);
				n++;
			}
		}
    }

	function DrawName(content,i)
	{
		var lines = content.split('\r\n');
		var count = 0;
		ctx.strokeStyle = document.getElementById('color').value;
		ctx.lineWidth = document.getElementById('wid').value;
		for(var j=0;j<lines.length;j++)
		{
			var str = lines[j];
			if(str=='END')
			{		
				ctx.stroke();
				count = 0;
				continue;
			}
			var point = str.split(',');
			if(point.length<2)
			{
				count = 1;
				continue;
			}
			if(count == 1)
			{	
				ctx.beginPath();
				ctx.moveTo(point[0]*a+startX+dis*i,point[1]*a+startY);
				count++;
			}
			else
			{
				ctx.lineTo(point[0]*a+startX+dis*i,point[1]*a+startY);
			}
		}
	}


</script> 

</body>
</html>
